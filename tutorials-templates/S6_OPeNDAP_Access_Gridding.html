<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang=""><head>
  <meta charset="utf-8">
  <meta name="generator" content="quarto-0.2.232">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
  <title>s6_opendap_access_gridding</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>

  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
  <script src="../site_libs/quarto-nav/quarto-nav.js"></script>
  <script src="../site_libs/quarto-nav/headroom.min.js"></script>
  <script src="../site_libs/clipboard/clipboard.min.js"></script>
  <meta name="quarto:offset" content="../">
  <script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
  <script src="../site_libs/quarto-search/fuse.min.js"></script>
  <script src="../site_libs/quarto-search/quarto-search.js"></script>
  <script src="../site_libs/quarto-html/quarto.js"></script>
  <script src="../site_libs/quarto-html/popper.min.js"></script>
  <script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
  <script src="../site_libs/quarto-html/anchor.min.js"></script>
  <link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
  <link class="quarto-color-scheme" href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet">
  <link class="quarto-color-scheme quarto-color-alternate" rel="prefetch" href="../site_libs/quarto-html/quarto-syntax-highlighting-dark.css">
  <script src="../site_libs/bootstrap/bootstrap.min.js"></script>
  <link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
  <link class="quarto-color-scheme" href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet">
  <link class="quarto-color-scheme quarto-color-alternate" rel="prefetch" href="../site_libs/bootstrap/bootstrap-dark.min.css">
  <script id="quarto-search-options" type="application/json">{
    "location": "sidebar",
    "copy-button": false,
    "collapse-after": 2,
    "panel-placement": "start",
    "type": "textbox",
    "limit": 20
  }</script>
  <link rel="stylesheet" href="../styles.css">
</head>
<body>
<div id="quarto-search-results"></div>
<header id="quarto-header" class="headroom fixed-top">
<nav class="quarto-secondary-nav py-2 d-lg-none d-md-block " data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <div class="container-fluid d-flex justify-content-between">
    <h1 class="quarto-secondary-nav-title mb-0 fs-3 d-inline">(Untitled)</h1>
    <button type="button" class="quarto-btn-toggle btn d-lg-none py-0 px-1 d-inline-block border-0 ">
      <i class="bi bi-chevron-right"></i>
    </button>
  </div>
</nav>
</header>
 <!-- /navbar/sidebar -->
<div class="container-fluid quarto-container d-flex flex-column page-layout-article">
<div class="row flex-fill" id="quarto-content">
  <div id="quarto-sidebar" class="col col-12 col-lg-3 d-lg-flex px-0 pt-0 sidebar collapse sidebar-navigation">
    <nav class="me-lg-auto docked overflow-auto">
  <div class="px-3 pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
    <img src="https://user-images.githubusercontent.com/2915555/133525653-2a2278b1-1015-4350-b2a5-160d125aaaf7.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">2021 Cloud Hackathon</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/nasa-openscapes/2021-Cloud-Hackathon" title="" class="sidebar-tool px-1"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-color-scheme-toggle sidebar-tool" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
  </div>
    <div class="px-3 mt-2 flex-shrink-0 align-items-center">
      <div class="sidebar-search">
      <div id="quarto-search" class="mb-0 " title="Search">
</div>
      </div>
    </div>
  <div class="sidebar-menu-container"> 
  <ul class="list-unstyled mt-1 px-3">
      <li class="sidebar-item">
  <a href="../index.html" class="">Welcome</a>
</li>
      <ul class="list-unstyled sidebar-section depth1">
    <li class="">
        <div class="me-auto">
          <div class="d-inline-flex w-100 sidebar-section-item">
            <div class="sidebar-section-link me-auto">
            <a href="../logistics/index.html" class="">Logistics</a>
            </div>
            <a class="text-start  " data-bs-toggle="collapse" data-bs-target="#logistics-collapse" aria-expanded="true">
              <div><i class="bi bi-chevron-right ms-2"></i></div>
            </a>
            </div>
        </div>
      <div class="collapse  show" id="logistics-collapse">
        <ul class="list-unstyled sidebar-item-contents">
          <li class="sidebar-item">
  <a href="../logistics/schedule.html" class="">Schedule</a>
</li>
          <li class="sidebar-item">
  <a href="../logistics/prerequisites.html" class="">Prerequisites, setup, &amp; getting help</a>
</li>
        </ul>
      </div>
    </li>
  </ul>
      <ul class="list-unstyled sidebar-section depth1">
    <li class="">
        <div class="me-auto">
          <div class="d-inline-flex w-100 sidebar-section-item">
            <div class="sidebar-section-link me-auto">
            <a href="../clinic/index.html" class="">Pre-Hackathon Clinic</a>
            </div>
            <a class="text-start  " data-bs-toggle="collapse" data-bs-target="#pre-hackathonclinic-collapse" aria-expanded="true">
              <div><i class="bi bi-chevron-right ms-2"></i></div>
            </a>
            </div>
        </div>
      <div class="collapse  show" id="pre-hackathonclinic-collapse">
        <ul class="list-unstyled sidebar-item-contents">
          <li class="sidebar-item">
  <a href="../clinic/jupyterhub.html" class="">NASA Openscapes Cloud Environment</a>
</li>
          <li class="sidebar-item">
  <a href="../clinic/notebooks.html" class="">Notebooks, Python, Git</a>
</li>
          <li class="sidebar-item">
  <a href="../clinic/github.html" class="">GitHub</a>
</li>
          <li class="sidebar-item">
  <a href="../clinic/earthdata.html" class="">Earthdata Login</a>
</li>
        </ul>
      </div>
    </li>
  </ul>
      <ul class="list-unstyled sidebar-section depth1">
    <li class="">
        <div class="me-auto">
          <div class="d-inline-flex w-100 sidebar-section-item">
            <div class="sidebar-section-link me-auto">
            <a href="../tutorials/index.html" class="">Tutorials</a>
            </div>
            <a class="text-start  " data-bs-toggle="collapse" data-bs-target="#tutorials-collapse" aria-expanded="true">
              <div><i class="bi bi-chevron-right ms-2"></i></div>
            </a>
            </div>
        </div>
      <div class="collapse  show" id="tutorials-collapse">
        <ul class="list-unstyled sidebar-item-contents">
          <li class="sidebar-item">
  <a href="../tutorials/getting-set-up.html" class="">Getting set up and connected</a>
</li>
          <li class="sidebar-item">
  <a href="../tutorials/Data_discovery_with_cmr.html" class="">Data discovery with CMR</a>
</li>
          <li class="sidebar-item">
  <a href="../tutorials/Data_Discovery__CMR-STAC_API.html" class="">Data Discovery with CMR-STAC API</a>
</li>
          <li class="sidebar-item">
  <a href="../tutorials/Introduction_to_xarray.html" class="">Introduction to <code>xarray</code></a>
</li>
          <li class="sidebar-item">
  <a href="../tutorials/NASA_Earthdata_Authentication.html" class="">Authentication for NASA Earthdata</a>
</li>
          <li class="sidebar-item">
  <a href="../tutorials/Data_Access__Direct_S3_Access.html" class="">Direct S3 Data Access</a>
</li>
          <li class="sidebar-item">
  <a href="../tutorials/S6_OPeNDAP_Access_Gridding.html" class="">Sentinel-6 MF L2 Altimetry Data Access (OPeNDAP) &amp; Gridding</a>
</li>
          <li class="sidebar-item">
  <a href="../tutorials/Data_Access__Direct_S3_Access__PODAAC_ECCO_SSH.html" class="">Direct S3 Data Access - Rough PODAAC ECCO SSH Example</a>
</li>
          <li class="sidebar-item">
  <a href="../tutorials/Data_Access__Harmonize-cloud-non-cloud.html" class="">Harmonizing data located within and outside of the NASA Earthdata Cloud</a>
</li>
          <li class="sidebar-item">
  <a href="../tutorials/Data_Access__Harmony_Subsetting.html" class="">Data Subsetting and Transformation Services in the Cloud</a>
</li>
          <li class="sidebar-item">
  <a href="../tutorials/Zarr_Access.html" class="">Access parts of NetCDF4 files using the zarr-eosdis-store library</a>
</li>
        </ul>
      </div>
    </li>
  </ul>
      <li class="sidebar-item">
  <a href="../tutorials-templates/index.html" class="">Tutorial Templates</a>
</li>
      <ul class="list-unstyled sidebar-section depth1">
    <li class="">
        <div class="me-auto">
          <div class="d-inline-flex w-100 sidebar-section-item">
            <div class="sidebar-section-link me-auto">
            <a href="../projects/index.html" class="">Projects</a>
            </div>
            <a class="text-start  " data-bs-toggle="collapse" data-bs-target="#projects-collapse" aria-expanded="true">
              <div><i class="bi bi-chevron-right ms-2"></i></div>
            </a>
            </div>
        </div>
      <div class="collapse  show" id="projects-collapse">
        <ul class="list-unstyled sidebar-item-contents">
          <li class="sidebar-item">
  <a href="../projects/workflow.html" class="">Collaborative workflow</a>
</li>
          <li class="sidebar-item">
  <a href="../projects/hackathon-projects.html" class="">Hackathon Projects</a>
</li>
        </ul>
      </div>
    </li>
  </ul>
      <ul class="list-unstyled sidebar-section depth1">
    <li class="">
        <div class="me-auto">
            <a class="sidebar-section-item d-inline-flex text-start w-100 " data-bs-toggle="collapse" data-bs-target="#additionalresources-collapse" aria-expanded="true">
              <div class="me-auto sidebar-section-item">Additional Resources</div>
            <div><i class="bi bi-chevron-right ms-2"></i></div>
            </a>
        </div>
      <div class="collapse  show" id="additionalresources-collapse">
        <ul class="list-unstyled sidebar-item-contents">
          <li class="sidebar-item">
  <a href="../tutorials/Additional_Resources__Direct_S3_Access__gdalvrt.html" class="">Direct S3 Data Access with GDAL Virtual Raster Format (VRT)</a>
</li>
          <li class="sidebar-item">
  <a href="../tutorials/Additional_Resources__Direct_S3_Access__rioxarray_clipping.html" class="">Direct S3 Data Access</a>
</li>
        </ul>
      </div>
    </li>
  </ul>
  </ul>
  </div>
</nav>
  </div>
  <div id="quarto-toc-sidebar" class=" pt-0 col col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-toc order-last"><nav id="TOC" role="doc-toc">
<h2 id="toc-title">On this page</h2>
<ul>
<li><a href="#sentinel-6-mf-l2-altimetry-data-access-opendap-gridding" class="nav-link active" data-scroll-target="#sentinel-6-mf-l2-altimetry-data-access-opendap-gridding">Sentinel-6 MF L2 Altimetry Data Access (OPeNDAP) &amp; Gridding</a>
<ul class="collapse">
<li><a href="#getting-started" class="nav-link" data-scroll-target="#getting-started">Getting Started</a>
<ul class="collapse">
<li><a href="#summary" class="nav-link" data-scroll-target="#summary">Summary</a></li>
<li><a href="#objectives" class="nav-link" data-scroll-target="#objectives">Objectives</a></li>
<li><a href="#requirements" class="nav-link" data-scroll-target="#requirements">Requirements</a></li>
<li><a href="#workspace" class="nav-link" data-scroll-target="#workspace">Workspace</a></li>
</ul></li>
<li><a href="#datasets" class="nav-link" data-scroll-target="#datasets">Dataset(s)</a>
<ul class="collapse">
<li><a href="#render-along-track-altimetry-data-to-the-ecco-grid" class="nav-link" data-scroll-target="#render-along-track-altimetry-data-to-the-ecco-grid">Render along-track altimetry data to the ECCO grid</a></li>
<li><a href="#grid-ssha-or-a-similar-variable" class="nav-link" data-scroll-target="#grid-ssha-or-a-similar-variable">Grid ssha or a similar variable</a></li>
</ul></li>
</ul></li>
</ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/nasa-openscapes/2021-Cloud-Hackathon/edit/main/tutorials-templates/S6_OPeNDAP_Access_Gridding.ipynb" class="toc-action">Edit this page</a></p><p><a href="https://github.com/nasa-openscapes/2021-Cloud-Hackathon/issues/new" class="toc-action">Report an issue</a></p></div></div></nav></div>
  <div class="col mx-auto col-sm-12 col-md-9 col-lg-7 col-xl-7 px-lg-4 pe-xxl-4 ps-xxl-0">
<main>

<section id="sentinel-6-mf-l2-altimetry-data-access-opendap-gridding" class="level1">
<h1>Sentinel-6 MF L2 Altimetry Data Access (OPeNDAP) &amp; Gridding</h1>
<p>To-dos: * Add tutorial objectives, e.g.&nbsp;How much data are we selecting/where? Over a certain Cycle? * What is the goal of the tutorial? e.g.&nbsp;Grab ___ cycle(s)/pass(es) to plot satellite altimetry tracks from S6 using opendap in the cloud to only select data we are interested in, reducing the data volume and time-to-data.</p>
<section id="getting-started" class="level2">
<h2 class="anchored" data-anchor-id="getting-started">Getting Started</h2>
<section id="summary" class="level3">
<h3 class="anchored" data-anchor-id="summary">Summary</h3>
<p><em>Description goes here…</em></p>
</section>
<section id="objectives" class="level3">
<h3 class="anchored" data-anchor-id="objectives">Objectives</h3>
<p>In this tutorial you will learn…</p>
<ol type="1">
<li>about level 2 radar altimetry data from the Sentinel-6 Michael Freilich mission;</li>
<li>how to efficiently download variable subsets using OPeNDAP;</li>
<li>how to grid the along-track altimetry observations produced by S6 at level 2.;</li>
</ol>
</section>
<section id="requirements" class="level3">
<h3 class="anchored" data-anchor-id="requirements">Requirements</h3>
<p>This workflow was developed using Python 3.9 (and tested against versions 3.7, 3.8).</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os.path</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> json</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> warnings</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> requests</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> xarray <span class="im">as</span> xr</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tqdm <span class="im">import</span> tqdm</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> io <span class="im">import</span> StringIO</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> concurrent.futures <span class="im">import</span> ThreadPoolExecutor</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>warnings.filterwarnings(<span class="st">"ignore"</span>)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pyresample <span class="im">as</span> pr</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pyresample.kd_tree <span class="im">import</span> resample_gauss</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="workspace" class="level3">
<h3 class="anchored" data-anchor-id="workspace">Workspace</h3>
<p>Create some directories inside a temporary user workspace. They will be used to write outputs.</p>
<blockquote class="blockquote">
<p>https://docs.python.org/3/library/os.html#os.makedirs</p>
</blockquote>
</section>
</section>
<section id="datasets" class="level2">
<h2 class="anchored" data-anchor-id="datasets">Dataset(s)</h2>
<p>This example operates on Level 2 Low Resolution Altimetry from Sentinel-6 Michael Freilich (the Near Real Time Reduced distribution). It is most easily identified by its collection <em>ShortName</em>, given below:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>ShortName <span class="op">=</span> <span class="st">'JASON_CS_S6A_L2_ALT_LR_RED_OST_NRT_F'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<section id="collection" class="level4">
<h4 class="anchored" data-anchor-id="collection">collection</h4>
<p>Get metadata about the collection from the CMR.</p>
<p>Get the collection’s <em>concept-id</em> from the record’s <code>meta</code> object. It uniquely identifies the collection in the CMR and is a component of the OPeNDAP endpoints for its granules.</p>
<blockquote class="blockquote">
<p>https://docs.python-requests.org/en/latest/api/#requests.get</p>
</blockquote>
</section>
<section id="granules" class="level4">
<h4 class="anchored" data-anchor-id="granules">granules</h4>
<p>Get metadata about the granules in the collection from the CMR.</p>
<blockquote class="blockquote">
<p>https://docs.python.org/3/library/io.html#io.StringIO<br>
https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.read_csv.html<br>
https://docs.python-requests.org/en/latest/api/#requests.get</p>
</blockquote>
<p>Load the results to a data frame.</p>
<blockquote class="blockquote">
<p>https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.iloc.html</p>
</blockquote>
<p>Display the list of items created by splitting the a value in the <code>Granule UR</code> field.</p>
<p>References:<br>
https://docs.python.org/3/library/stdtypes.html#str.split<br>
https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.iloc.html</p>
<p><em>Note that cycle and pass are items 8 and 9, respectively, after splitting the <code>Granule UR</code> field by <code>_</code>.</em> Add two columns containing the cycle/pass numbers for granules in the table.</p>
<blockquote class="blockquote">
<p>https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.copy.html<br>
https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.apply.html<br>
https://docs.python.org/3/reference/expressions.html#lambda<br>
https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.iloc.html</p>
</blockquote>
<p>Now create a table with one row per cycle and with these columns:</p>
<ol type="1">
<li>start time</li>
<li>end time</li>
<li>granule names (list)</li>
</ol>
<blockquote class="blockquote">
<p>https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.to_frame.html<br>
https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.groupby.html</p>
</blockquote>
</section>
<section id="pick-a-cycle-of-interest" class="level4">
<h4 class="anchored" data-anchor-id="pick-a-cycle-of-interest">Pick a cycle of interest</h4>
<p>Pick one cycle that is nearly complete, &gt;= 120 orbits/files. Limit options to cycles with at least 120 granules/files available (i.e.&nbsp;orbits in S6 context).</p>
<p>Choose from the nearly-complete cycles that remain in the table, which start with cycle number <code>023</code> for S6 data in the public domain (and start on June 22). Slice the table of <em>granules</em> to exclude all rows that are not from the cycle of interest.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>my_cycle <span class="op">=</span> <span class="bu">int</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="opendap-access-endpoints" class="level4">
<h4 class="anchored" data-anchor-id="opendap-access-endpoints">OPeNDAP Access Endpoints</h4>
<p>All endpoints for granules/files in OPeNDAP/Hyrax start with the server hostname and path to the parent collection, followed by <em>granules</em>. The collection is specified by the <em>concept-id</em> given right after <em>collections</em> in a valid url. The next cell formats a string giving the base url to which we will append granule filenames (stored in the <code>Granule UR</code> column of the <em>granules</em> table) to get the full url/endpoint for each granule.</p>
<p><em>Fyi, the url printed by this cell will not be accessible from your web browser.</em></p>
<blockquote class="blockquote">
<p>https://docs.python.org/3/library/string.html#format-string-syntax</p>
</blockquote>
<p>Appending the granule name (taken from the <code>Granule UR</code> column) to the end of the url above results in a valid endpoint. You can click the one printed by this cell to confirm. A new browser tab should open to the HTML access form served by Hyrax/OPeNDAP.</p>
<p>Make a new column with the <code>nc4</code> download url for all granules.</p>
<blockquote class="blockquote">
<p>https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.info.html</p>
</blockquote>
<section id="pick-target-datacoordinate-variables" class="level5">
<h5 class="anchored" data-anchor-id="pick-target-datacoordinate-variables">Pick target data/coordinate variables</h5>
<p>Display the url to access the DDS file for the first granule:</p>
<blockquote class="blockquote">
<p>https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.iloc.html</p>
</blockquote>
<p>Assemble the list of target variables that you will subset from each granule/file using OPeNDAP.</p>
<blockquote class="blockquote">
<p>https://docs.python.org/3/library/stdtypes.html#list</p>
</blockquote>
<p>Join the list of variables with commas and append the resulting string to the end of each opendap <code>nc4</code> endpoint created during the steps above. The variables given after the <code>?</code> will be subset from the source file on the server-side into a new netCDF4 file that OPeNDAP returns in response content which is downloaded over https.</p>
<p>Here’s an example for the first granule in the selected cycle. Clicking this link should download a netCDF4 containing the target variables (4 of them, in my case). *You may be prompted to authenticate with your Earthdata Login account info.</p>
<blockquote class="blockquote">
<p>https://opendap.github.io/documentation/UserGuideComprehensive.html#Constraint_Expressions (Hyrax/OPeNDAP docs)</p>
</blockquote>
</section>
</section>
<section id="download-subsets" class="level4">
<h4 class="anchored" data-anchor-id="download-subsets">Download subsets</h4>
<p>This function downloads one granule from the remote <code>url</code> to a local <code>target</code> path, and will reliably manage simultaneous streaming downloads divided between multiple threads.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> download(url: <span class="bu">str</span>, target: <span class="bu">str</span>, force: <span class="bu">bool</span><span class="op">=</span><span class="va">False</span>):</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> os.path.isfile(target) <span class="kw">or</span> force <span class="kw">is</span> <span class="va">True</span>:</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>        <span class="cf">with</span> requests.get(url) <span class="im">as</span> response, <span class="bu">open</span>(target, <span class="st">'wb'</span>) <span class="im">as</span> <span class="bu">file</span>:</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> response.status_code <span class="op">//</span> <span class="dv">100</span> <span class="op">==</span> <span class="dv">2</span>: </span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>                <span class="cf">raise</span> <span class="pp">Exception</span>(response.text)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> chunk <span class="kw">in</span> response.iter_content(chunk_size<span class="op">=</span><span class="dv">1024</span>):</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> chunk:</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">file</span>.write(chunk)</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> target</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<blockquote class="blockquote">
<p>https://docs.python.org/3/library/os.path.html#os.path.isfile<br>
https://docs.python-requests.org/en/latest/api/#requests.Response.text<br>
https://docs.python-requests.org/en/latest/api/#requests.Response.status_code<br>
https://docs.python-requests.org/en/latest/api/#requests.Response.iter_content</p>
</blockquote>
<div class="sourceCode" id="cb5"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co">#!ls data/subsets/*NR_025*.nc4 | wc -l</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co">#!rm data/subsets/*NR_025*.nc4</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><em>This next cell assembles a list of local paths for the subset downloads.</em></p>
<p>Calling <code>tolist</code> on the resulting Series will convert it to a Python list (by way of the <em>numpy</em> method, <em>tolist</em>). Use <em>zip</em> merge the lists of <em>subset</em> urls and local paths, itemwise. The result will be a list of lists, each length two and containing a remote url and local path (corresponding to two positional arguments in the <em>download</em> function that will be defined in a subsequent cell).</p>
<blockquote class="blockquote">
<p>https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.tolist.html</p>
</blockquote>
<p><em>This next cell creates a pool of workers to divide the list of downloads between multiple threads.</em></p>
<p>Use the <code>ThreadPoolExecutor</code> from <code>concurrent.futures</code> module (in the Python 3 standard library) to divide the 120+ download jobs between multiple threads and run them concurrently. This should take no more than a minute or two to process all subsets on the server side and download to the local host.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> ThreadPoolExecutor(max_workers<span class="op">=</span><span class="dv">12</span>) <span class="im">as</span> pool:</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>    workers <span class="op">=</span> pool.<span class="bu">map</span>(<span class="kw">lambda</span> x: download(<span class="op">*</span>x), download_arguments)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>    granules[<span class="st">'local'</span>] <span class="op">=</span> <span class="bu">list</span>(tqdm(workers, total<span class="op">=</span><span class="bu">len</span>(download_arguments)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<blockquote class="blockquote">
<p>https://docs.python.org/3/library/concurrent.futures.html#threadpoolexecutor</p>
</blockquote>
<p>The source files range from 2.5MB to 3.0MB. These OPeNDAP subsets are ~100KB apiece. (anecdote: it took less than 10 minutes to download subsets for &gt;1700 granules/files when I ran this routine for all cycles going back to 2021-06-22.) Here we call the shell <em>du</em> and <em>ls</em> utilities to get the size of the directory:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>bash</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="co">#ls</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co">#du</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<blockquote class="blockquote">
<p>https://www.gnu.org/software/coreutils/manual/html_node/du-invocation.html</p>
</blockquote>
<p>Confirm that a netcdf file exists on disk for all the file paths in the <em>local</em> column.</p>
<blockquote class="blockquote">
<p>https://docs.python.org/3/library/functions.html#sorted<br>
https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.all.html</p>
</blockquote>
</section>
<section id="aggregate-to-cycle" class="level4">
<h4 class="anchored" data-anchor-id="aggregate-to-cycle">Aggregate to cycle</h4>
<p>Make a dictionary to rename variables so that the <code>data_01_</code> prefix is removed from each one.</p>
<p>References:<br>
https://docs.python.org/3/library/functions.html#map<br>
https://docs.python.org/3/library/functions.html#zip</p>
<p>Sort the list of local paths to the downloaded subsets to ensure they concatenate in proper order. Call <code>open_mfdataset</code> on the list to open all the subsets in memory as one dataset in xarray.</p>
<blockquote class="blockquote">
<p>https://tqdm.github.io/docs/tqdm/#pandas<br>
https://xarray.pydata.org/en/stable/generated/xarray.open_mfdataset.html<br>
https://xarray.pydata.org/en/stable/generated/xarray.Dataset.rename.html</p>
</blockquote>
</section>
<section id="render-along-track-altimetry-data-to-the-ecco-grid" class="level3">
<h3 class="anchored" data-anchor-id="render-along-track-altimetry-data-to-the-ecco-grid">Render along-track altimetry data to the ECCO grid</h3>
<blockquote class="blockquote">
<p><strong>Acknowledgement</strong> <em>This approach using <code>pyresample</code> was shared to me by Ian Fenty, ECCO Lead.</em></p>
</blockquote>
<p>ECCO V4r4 products are distributed in two spatial formats. One set of collections provides the ocean state estimates on the native model grid (LLC0090) and the other provides them after interpolating to a regular grid defined in geographic coordinates with horizontal cell size of 0.5-degrees.</p>
<section id="download-the-ecco-v4r4-0.5-deg-grid-geometry-and-mask" class="level4">
<h4 class="anchored" data-anchor-id="download-the-ecco-v4r4-0.5-deg-grid-geometry-and-mask">Download the ECCO V4r4 0.5-Deg Grid Geometry and Mask</h4>
<p>It’s distributed as its own dataset/collection containing just one file. We can access it over OPeNDAP like demonstrated above or simply download it from the HTTPS download endpoint – the file size is inconsequential. The next cell downloads the file into the <em>data</em> folder from the granule’s https endpoint.</p>
<blockquote class="blockquote">
<p>https://docs.python.org/3/library/os.path.html#os.path.basename<br>
https://xarray.pydata.org/en/stable/generated/xarray.open_dataset.html</p>
</blockquote>
<p>The <code>maskC</code> variable contains a boolean mask representing the wet/dry state of the area contained in each cell of the 3d grid defined by <code>Z</code> and <code>latitude</code> and <code>longitude</code>.</p>
<p>Here are the variable’s attributes:</p>
<p>So, the mask derives from another variable <code>hFacC</code> that essentially describes 3d space/volume contained within each model grid cell by the fractional area representing the horizontal coverage (in the <code>longitude,latitude</code> dimensions) within each vertical/depth layer.</p>
<p>Select the 2d array from <code>maskC</code> that corresponds to the depth layer at ocean surface (i.e.&nbsp;at index <code>0</code> on the <code>Z</code> axis/dimension) and then produce a boolean array where True represents cells with a value greater than <code>0</code>. The resulting array/grid is our land/water mask for the 2d grids generated during the next few steps.</p>
<p>Plot the land/water mask:</p>
<blockquote class="blockquote">
<p>https://xarray.pydata.org/en/stable/generated/xarray.DataArray.isel.html<br>
https://xarray.pydata.org/en/stable/generated/xarray.DataArray.plot.html</p>
</blockquote>
</section>
</section>
<section id="grid-ssha-or-a-similar-variable" class="level3">
<h3 class="anchored" data-anchor-id="grid-ssha-or-a-similar-variable">Grid ssha or a similar variable</h3>
<p><em>Jinbo’s recommendation: wrap this logic for parameterization by workshop attendees.</em></p>
<p>Get a single timestamp to represent the midpoint of the cycle.</p>
<p>Access the target variable, <em>ssha</em> in this case, and make a nan mask.</p>
<p>Define a simple function <em>get_grid_defn</em> to validate input arrays of longitudes/latitudes and return a <em>pyresample.geometry.SwathDefinition</em> object. (We use it twice to define source/target grids in the next steps.)</p>
<p>Define source grid/geometry for the input along-track data. (They are stored as 1-dimensional arrays.)</p>
<p>Define target grid based on the longitudes and latitudes from the ECCO grid geometry dataset. This time define the grid using two 2-dimensional arrays that give positions of all SSHA values in geographic/longitude-latitude coordinates.</p>
<p>Make the <em>pyresample</em> object for the target grid and proceed.</p>
<p>Show the help for <code>pyresample.kdtree.resample_gauss</code> to aid during the hackathon.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co">#help(resample_gauss)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Get the target grid definition defined by the 2d arrays of lons and lats created in the cell above. Apply gaussian resampling with some optional arguments (borrowed from Ian’s implementation).</p>
<p>Apply the land/water mask in the numpy array created from the ECCO layer in the steps above. Then, convert the masked numpy array to an xarray data array object named <em>gridded</em>. Print its header.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co">#ssha, stddev, counts</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Plot the resulting arrays with xarray.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co">#ssha</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb11"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co">#stddev</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb12"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co">#counts</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Additional References:</strong></p>
<ul>
<li><em>numpy</em> (https://numpy.org/doc/stable/reference)
<ul>
<li><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.data.html">numpy.ndarray.data</a><br>
</li>
<li><a href="https://numpy.org/doc/stable/reference/generated/numpy.ravel.html">numpy.ravel</a><br>
</li>
<li><a href="https://numpy.org/doc/stable/reference/generated/numpy.where.html">numpy.where</a><br>
</li>
<li><a href="https://numpy.org/doc/stable/reference/generated/numpy.isnan.html">numpy.isnan</a><br>
</li>
<li><a href="https://numpy.org/doc/stable/reference/arrays.datetime.html">datetimes</a><br>
</li>
</ul></li>
<li><em>xarray</em> (https://xarray.pydata.org/en/stable)
<ul>
<li><a href="https://xarray.pydata.org/en/stable/generated/xarray.DataArray.html">xarray.DataArray</a><br>
</li>
<li><a href="https://xarray.pydata.org/en/stable/generated/xarray.DataArray.values.html">xarray.DataArray.values</a><br>
</li>
<li><a href="https://xarray.pydata.org/en/stable/generated/xarray.DataArray.mean.html">xarray.DataArray.mean</a><br>
</li>
<li>https://xarray.pydata.org/en/stable/generated/xarray.DataArray.plot.pcolormesh.html (matplotlib)<br>
</li>
</ul></li>
<li><em>pyresample</em> (https://pyresample.readthedocs.io/en/latest/api/pyresample)
<ul>
<li><a href="https://pyresample.readthedocs.io/en/latest/api/pyresample.utils.html#pyresample.utils.check_and_wrap">pyresample.utils.check_and_wrap</a><br>
</li>
<li><a href="https://pyresample.readthedocs.io/en/latest/api/pyresample.html#pyresample.kd_tree.resample_gauss">pyresample.kd_tree.resample_gauss</a><br>
</li>
<li><a href="https://pyresample.readthedocs.io/en/latest/api/pyresample.html#pyresample.geometry.SwathDefinition">pyresample.geometry.SwathDefinition</a></li>
</ul></li>
</ul>
<p><strong>Bonus</strong>: generate a grid for every cycle and get mean/std over all the cycles</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>stack <span class="op">=</span> xr.concat(data[<span class="st">'grid'</span>].tolist(), dim<span class="op">=</span><span class="st">"time"</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>midlat <span class="op">=</span> stack.sel(latitude<span class="op">=</span><span class="bu">slice</span>(<span class="op">-</span><span class="fl">66.</span>,<span class="fl">66.0</span>))</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>stats <span class="op">=</span> xr.concat(objs<span class="op">=</span>[midlat.mean(<span class="st">"time"</span>),</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>                        midlat.std(<span class="st">"time"</span>) ], </span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>                  dim<span class="op">=</span>pd.Index([<span class="st">'mean'</span>,<span class="st">'std'</span>], name<span class="op">=</span><span class="st">"stat"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<blockquote class="blockquote">
<p>https://xarray.pydata.org/en/stable/generated/xarray.concat.html</p>
</blockquote>
<p><strong>Bonus</strong>: calculate area-weighted mean</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> to_area_weighted_mean(x):</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>    nonzero_mask <span class="op">=</span> np.where(<span class="op">~</span>np.isnan(x), <span class="dv">1</span>, np.nan)            <span class="co"># mask where nans=0 &amp; ~nans=1</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>    nonzero_area <span class="op">=</span> np.<span class="bu">sum</span>(nonzero_mask <span class="op">*</span> ecco_grid.area)        <span class="co"># total area where data is nonzero</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">float</span>(np.nansum(x <span class="op">*</span> ecco_grid.area) <span class="op">/</span> nonzero_area)  <span class="co"># area-weighted global mean</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<blockquote class="blockquote">
<p>https://numpy.org/doc/stable/reference/generated/numpy.sum.html<br>
https://numpy.org/doc/stable/reference/generated/numpy.nansum.html</p>
</blockquote>


</section>
</section>
</section>
<script type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('div.sidebar-toc .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
    } else {
      disableStylesheet(alternateStylesheets);
    }
    manageTransitions('.quarto-toc-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      return window.localStorage.getItem("quarto-color-scheme");
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = null;
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.id = "quarto-color-scheme-toggle";
    a.classList.add('top-right');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } 
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    setTimeout(function() {
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    window.tippy(el, {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    }); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</main>
<div class="page-navigation page-navigation-docked">
  <div class="nav-page nav-page-previous">
  </div>
  <div class="nav-page nav-page-next">
  </div>
</div>
</div> <!-- /main column -->
</div> <!-- /row -->
<div class="row">
  <div class="nav-footer">
      <div class="nav-footer-center me-auto ms-auto">PODAAC, NSIDC DAAC and LPDAAC (2021). 2021 Cloud Hackathon</div>
  </div>
</div>
</div> <!-- /container fluid -->


</body></html>